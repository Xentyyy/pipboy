<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PIP-BOY HAVA DURUMU</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Share Tech Mono', monospace;
            background: #000;
            color: #0f0;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            opacity: 1;
            transition: opacity 0.5s;
        }

        .loading-screen.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .loading-vault-boy {
            width: 200px;
            height: 200px;
            margin-bottom: 30px;
            filter: drop-shadow(0 0 30px #0f0);
            animation: vaultBoyPulse 2s ease-in-out infinite;
        }

        @keyframes vaultBoyPulse {
            0%, 100% { transform: scale(1); filter: drop-shadow(0 0 30px #0f0); }
            50% { transform: scale(1.05); filter: drop-shadow(0 0 50px #0f0); }
        }

        .loading-text {
            font-size: 18px;
            text-align: center;
            line-height: 2;
            text-shadow: 0 0 10px #0f0;
            min-height: 200px;
        }

        .loading-text::after {
            content: 'â–Œ';
            animation: blink 0.7s infinite;
        }

        .pipboy-container {
            width: 90vw;
            max-width: 1200px;
            height: 85vh;
            background: linear-gradient(135deg, #1a1a1a 0%, #0d0d0d 100%);
            border: 8px solid #2a5a3a;
            border-radius: 20px;
            box-shadow: 
                0 0 50px rgba(0, 255, 0, 0.3),
                inset 0 0 100px rgba(0, 255, 0, 0.05);
            position: relative;
            overflow: hidden;
        }

        .scanline {
            position: absolute;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                0deg,
                rgba(0, 255, 0, 0.03) 0px,
                transparent 1px,
                transparent 2px,
                rgba(0, 255, 0, 0.03) 3px
            );
            pointer-events: none;
            animation: flicker 0.15s infinite;
            z-index: 100;
        }

        @keyframes flicker {
            0% { opacity: 0.95; }
            50% { opacity: 1; }
            100% { opacity: 0.95; }
        }

        .screen-glow {
            position: absolute;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, rgba(0, 255, 0, 0.1) 0%, transparent 70%);
            pointer-events: none;
            z-index: 99;
        }

        .screen-transition {
            position: absolute;
            width: 100%;
            height: 100%;
            background: rgba(0, 255, 0, 0.3);
            pointer-events: none;
            z-index: 98;
            opacity: 0;
        }

        .screen-transition.active {
            animation: screenWave 0.5s ease-out;
        }

        @keyframes screenWave {
            0% { opacity: 0; transform: scaleY(1); }
            25% { opacity: 0.6; transform: scaleY(0.98) scaleX(1.02); }
            50% { opacity: 0.4; transform: scaleY(1.02) scaleX(0.98); }
            75% { opacity: 0.2; transform: scaleY(0.99) scaleX(1.01); }
            100% { opacity: 0; transform: scaleY(1) scaleX(1); }
        }

        .header {
            background: rgba(0, 100, 0, 0.3);
            padding: 15px 30px;
            border-bottom: 2px solid #0f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            font-size: 24px;
            text-shadow: 0 0 10px #0f0;
            letter-spacing: 3px;
        }

        .status-bar {
            display: flex;
            gap: 20px;
            font-size: 14px;
        }

        .main-content {
            display: flex;
            height: calc(100% - 150px);
        }

        .sidebar {
            width: 250px;
            background: rgba(0, 50, 0, 0.3);
            border-right: 2px solid #0f0;
            padding: 20px;
            overflow-y: auto;
        }

        .menu-item {
            padding: 15px 20px;
            margin: 10px 0;
            background: rgba(0, 100, 0, 0.2);
            border: 1px solid #0f0;
            cursor: pointer;
            transition: all 0.2s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .menu-item:hover,
        .menu-item.active {
            background: rgba(0, 255, 0, 0.3);
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.5);
            transform: translateX(5px);
        }

        .content-area {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
            position: relative;
        }

        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
            animation: fadeInContent 0.5s ease-out;
        }

        @keyframes fadeInContent {
            0% { 
                opacity: 0; 
                transform: translateX(-20px);
                filter: blur(5px);
            }
            100% { 
                opacity: 1; 
                transform: translateX(0);
                filter: blur(0);
            }
        }

        .data-panel {
            background: rgba(0, 100, 0, 0.1);
            border: 2px solid #0f0;
            padding: 20px;
            margin-bottom: 20px;
            position: relative;
        }

        .data-panel::before {
            content: '>';
            position: absolute;
            left: 5px;
            top: 5px;
            font-size: 20px;
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 49% { opacity: 1; }
            50%, 100% { opacity: 0; }
        }

        .data-panel h2 {
            color: #0f0;
            margin-bottom: 15px;
            font-size: 20px;
            text-shadow: 0 0 10px #0f0;
        }

        .data-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(0, 255, 0, 0.2);
        }

        .typewriter {
            overflow: hidden;
            white-space: pre-wrap;
            letter-spacing: 0.1em;
            line-height: 1.8;
        }

        .typewriter::after {
            content: 'â–Œ';
            animation: blink 0.7s infinite;
        }

        .footer {
            position: absolute;
            bottom: 0;
            width: 100%;
            background: rgba(0, 100, 0, 0.3);
            padding: 15px 30px;
            border-top: 2px solid #0f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .pip-button {
            padding: 8px 20px;
            background: rgba(0, 100, 0, 0.3);
            border: 2px solid #0f0;
            color: #0f0;
            cursor: pointer;
            text-transform: uppercase;
            font-family: 'Share Tech Mono', monospace;
            font-size: 12px;
            transition: all 0.2s;
        }

        .pip-button:hover {
            background: rgba(0, 255, 0, 0.4);
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.6);
        }

        .pip-button:active {
            transform: scale(0.95);
        }

        ::-webkit-scrollbar {
            width: 10px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.5);
        }

        ::-webkit-scrollbar-thumb {
            background: #0f0;
        }

        .weather-main {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .vault-boy-container {
            background: rgba(0, 100, 0, 0.1);
            border: 2px solid #0f0;
            padding: 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
            min-height: 400px;
        }

        .weather-effect {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .vault-boy {
            font-size: 150px;
            margin: 20px 0;
            filter: drop-shadow(0 0 20px #0f0);
            position: relative;
            z-index: 2;
        }

        .rain {
            position: absolute;
            width: 2px;
            height: 20px;
            background: linear-gradient(to bottom, transparent, #0f0);
            animation: fall linear infinite;
        }

        @keyframes fall {
            to {
                transform: translateY(100vh);
            }
        }

        .snow {
            position: absolute;
            width: 8px;
            height: 8px;
            background: #0f0;
            border-radius: 50%;
            animation: snowfall linear infinite;
        }

        @keyframes snowfall {
            to {
                transform: translateY(100vh) rotate(360deg);
            }
        }

        .sun-rays {
            position: absolute;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, rgba(0, 255, 0, 0.3), transparent);
            animation: pulse 3s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.6; }
        }

        .cloud {
            position: absolute;
            background: #0f0;
            opacity: 0.2;
            border-radius: 100px;
            animation: float 20s linear infinite;
        }

        @keyframes float {
            from { left: -100px; }
            to { left: 100%; }
        }

        .current-weather {
            background: rgba(0, 100, 0, 0.1);
            border: 2px solid #0f0;
            padding: 30px;
        }

        .temp-display {
            font-size: 72px;
            text-align: center;
            margin: 20px 0;
            text-shadow: 0 0 20px #0f0;
        }

        .weather-details {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }

        .detail-item {
            background: rgba(0, 100, 0, 0.1);
            border: 1px solid #0f0;
            padding: 15px;
            text-align: center;
        }

        .detail-item .label {
            font-size: 12px;
            opacity: 0.7;
            margin-bottom: 5px;
        }

        .detail-item .value {
            font-size: 24px;
            text-shadow: 0 0 10px #0f0;
        }

        .forecast-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }

        .forecast-item {
            background: rgba(0, 100, 0, 0.1);
            border: 2px solid #0f0;
            padding: 20px;
            text-align: center;
            transition: all 0.3s;
        }

        .forecast-item:hover {
            background: rgba(0, 255, 0, 0.2);
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.4);
        }

        .search-input {
            width: 100%;
            padding: 15px;
            background: rgba(0, 0, 0, 0.5);
            border: 2px solid #0f0;
            color: #0f0;
            font-family: 'Share Tech Mono', monospace;
            font-size: 16px;
            text-transform: uppercase;
            margin-bottom: 10px;
        }

        .search-input:focus {
            outline: none;
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.5);
        }

        .error {
            background: rgba(255, 0, 0, 0.1);
            border: 2px solid #f00;
            color: #f00;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }

        .radar-container {
            position: relative;
            width: 100%;
            height: 500px;
            background: rgba(0, 100, 0, 0.05);
            border: 2px solid #0f0;
            margin-top: 15px;
            overflow: hidden;
        }

        .radar-container iframe {
            width: 100%;
            height: 100%;
            border: none;
            filter: hue-rotate(90deg) saturate(1.5) brightness(0.9);
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div class="loading-screen" id="loading-screen">
        <img src="Icon_Fo4_side_quest.webp" class="loading-vault-boy" alt="Vault Boy">
        <div class="loading-text" id="loading-text"></div>
    </div>

    <div class="pipboy-container">
        <div class="scanline"></div>
        <div class="screen-glow"></div>
        <div class="screen-transition" id="screen-transition"></div>
        
        <div class="header">
            <h1>PIP-BOY HAVA DURUMU</h1>
            <div class="status-bar">
                <div>SAAT: <span id="current-time">--:--</span></div>
                <div>KONUM: <span id="location-name">--</span></div>
            </div>
        </div>

        <div class="main-content">
            <nav class="sidebar">
                <div class="menu-item active" data-section="current">GÃœNCEL</div>
                <div class="menu-item" data-section="forecast">TAHMÄ°N</div>
                <div class="menu-item" data-section="radar">RADAR</div>
                <div class="menu-item" data-section="details">DETAYLAR</div>
                <div class="menu-item" data-section="search">ARA</div>
            </nav>

            <div class="content-area">
                <div class="content-section active" id="current">
                    <div class="weather-main">
                        <div class="vault-boy-container">
                            <div id="weather-effect" class="weather-effect"></div>
                            <div id="vault-boy" class="vault-boy">ðŸ‘¤</div>
                            <div id="weather-desc" style="font-size: 20px; margin-top: 20px; position: relative; z-index: 2;">YÃœKLENIYOR...</div>
                        </div>

                        <div class="current-weather">
                            <h2 style="text-align: center; margin-bottom: 20px;">SICAKLIK</h2>
                            <div class="temp-display" id="temp-display">--Â°C</div>
                            <div class="data-row">
                                <span>Hissedilen:</span>
                                <span id="feels-like">--Â°C</span>
                            </div>
                            <div class="data-row">
                                <span>Min / Max:</span>
                                <span id="min-max">--Â°C / --Â°C</span>
                            </div>
                        </div>
                    </div>

                    <div class="weather-details">
                        <div class="detail-item">
                            <div class="label">NEM</div>
                            <div class="value" id="humidity">--%</div>
                        </div>
                        <div class="detail-item">
                            <div class="label">RÃœZGAR</div>
                            <div class="value" id="wind">--</div>
                        </div>
                        <div class="detail-item">
                            <div class="label">BASINÃ‡</div>
                            <div class="value" id="pressure">--</div>
                        </div>
                        <div class="detail-item">
                            <div class="label">GÃ–RÃœÅž</div>
                            <div class="value" id="visibility">--</div>
                        </div>
                    </div>
                </div>

                <div class="content-section" id="forecast">
                    <div class="data-panel">
                        <h2>7 GÃœNLÃœK TAHMÄ°N</h2>
                        <div id="forecast-container" class="forecast-grid"></div>
                    </div>
                </div>

                <div class="content-section" id="radar">
                    <div class="data-panel">
                        <h2>SÄ°STEM DURUMU</h2>
                        <div class="typewriter" id="radar-status"></div>
                    </div>

                    <div class="data-panel">
                        <h2>TÃœRKÄ°YE RADAR HARÄ°TASI</h2>
                        <div class="radar-container">
                            <iframe 
                                id="radar-frame"
                                src="https://embed.windy.com/embed2.html?lat=39.000&lon=35.000&detailLat=39.000&detailLon=35.000&width=650&height=450&zoom=6&level=surface&overlay=rain&product=ecmwf&menu=&message=&marker=&calendar=now&pressure=&type=map&location=coordinates&detail=&metricWind=default&metricTemp=default&radarRange=-1" 
                                allowfullscreen>
                            </iframe>
                        </div>
                        <div style="margin-top: 15px; text-align: center; font-size: 14px; opacity: 0.8;">
                            <p>CANLI RADAR GÃ–RÃœNTÃœLERÄ° - TÃœRKÄ°YE</p>
                            <p style="margin-top: 5px;">YaÄŸÄ±ÅŸ yoÄŸunluÄŸu, bulutlar ve meteorolojik veriler</p>
                        </div>
                    </div>

                    <div class="data-panel">
                        <h2>RADAR KATMANLARI</h2>
                        <div style="display: grid; gap: 10px;">
                            <button class="pip-button" onclick="changeRadarLayer('rain')">YAÄžIÅž KATMANI</button>
                            <button class="pip-button" onclick="changeRadarLayer('clouds')">BULUT KATMANI</button>
                            <button class="pip-button" onclick="changeRadarLayer('wind')">RÃœZGAR KATMANI</button>
                            <button class="pip-button" onclick="changeRadarLayer('temp')">SICAKLIK KATMANI</button>
                        </div>
                    </div>

                    <div class="data-panel">
                        <h2>RADAR BÄ°LGÄ°LERÄ°</h2>
                        <div class="typewriter" id="radar-info"></div>
                    </div>
                </div>

                <div class="content-section" id="details">
                    <div class="data-panel">
                        <h2>DETAYLI BÄ°LGÄ°LER</h2>
                        <div class="data-row"><span>GÃ¼n DoÄŸumu:</span><span id="sunrise">--:--</span></div>
                        <div class="data-row"><span>GÃ¼n BatÄ±mÄ±:</span><span id="sunset">--:--</span></div>
                        <div class="data-row"><span>UV Ä°ndeksi:</span><span id="uv-index">--</span></div>
                        <div class="data-row"><span>Bulutluluk:</span><span id="clouds">--%</span></div>
                        <div class="data-row"><span>RÃ¼zgar YÃ¶nÃ¼:</span><span id="wind-dir">--</span></div>
                    </div>
                </div>

                <div class="content-section" id="search">
                    <div class="data-panel">
                        <h2>ÅžEHÄ°R ARA</h2>
                        <input type="text" id="city-search" class="search-input" placeholder="ÅžEHÄ°R ADI GÄ°RÄ°N..." />
                        <button class="pip-button" style="width: 100%;" onclick="searchCity()">ARA</button>
                        <div id="search-error"></div>
                    </div>

                    <div class="data-panel">
                        <h2>POPÃœLER ÅžEHÄ°RLER</h2>
                        <div style="display: grid; gap: 10px;">
                            <button class="pip-button" onclick="loadCity('Istanbul')">Ä°STANBUL</button>
                            <button class="pip-button" onclick="loadCity('Ankara')">ANKARA</button>
                            <button class="pip-button" onclick="loadCity('Izmir')">Ä°ZMÄ°R</button>
                            <button class="pip-button" onclick="loadCity('Antalya')">ANTALYA</button>
                            <button class="pip-button" onclick="loadCity('London')">LONDON</button>
                            <button class="pip-button" onclick="loadCity('New York')">NEW YORK</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="footer">
            <div id="timestamp">--</div>
            <div style="display: flex; gap: 10px;">
                <button class="pip-button" onclick="getCurrentLocation()">KONUMUM</button>
                <button class="pip-button" onclick="refreshWeather()">YENÄ°LE</button>
            </div>
        </div>
    </div>

    <script>
        const apiKey = 'c97a6ce1476f468d942160643253107';
        let currentCity = 'Istanbul';
        let typingInProgress = false;
        let currentSection = 'current';

        // Check if first visit
        const hasVisited = sessionStorage.getItem('hasVisited');

        // Audio Context
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();

        function playClickSound() {
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.value = 800;
            oscillator.type = 'square';
            
            gainNode.gain.setValueAtTime(0.03, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.1);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.1);
        }

        function playSelectSound() {
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.setValueAtTime(600, audioContext.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(1200, audioContext.currentTime + 0.15);
            oscillator.type = 'sine';
            
            gainNode.gain.setValueAtTime(0.05, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.15);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.15);
        }

        function playTabSwitchSound() {
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.setValueAtTime(400, audioContext.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(800, audioContext.currentTime + 0.2);
            oscillator.type = 'triangle';
            
            gainNode.gain.setValueAtTime(0.04, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.2);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.2);
        }

        function playTypingSound() {
            if (!typingInProgress) return;
            
            const oscillator1 = audioContext.createOscillator();
            const oscillator2 = audioContext.createOscillator();
            const oscillator3 = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            const filter = audioContext.createBiquadFilter();
            
            oscillator1.connect(filter);
            oscillator2.connect(filter);
            oscillator3.connect(filter);
            filter.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator1.frequency.value = 400 + Math.random() * 100;
            oscillator2.frequency.value = 800 + Math.random() * 150;
            oscillator3.frequency.value = 1600 + Math.random() * 200;
            
            oscillator1.type = 'triangle';
            oscillator2.type = 'square';
            oscillator3.type = 'sine';
            
            filter.type = 'bandpass';
            filter.frequency.value = 1200;
            filter.Q.value = 1.5;
            
            gainNode.gain.setValueAtTime(0.025, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.04);
            
            oscillator1.start(audioContext.currentTime);
            oscillator2.start(audioContext.currentTime);
            oscillator3.start(audioContext.currentTime);
            oscillator1.stop(audioContext.currentTime + 0.04);
            oscillator2.stop(audioContext.currentTime + 0.04);
            oscillator3.stop(audioContext.currentTime + 0.04);
        }

        function triggerScreenTransition() {
            const transition = document.getElementById('screen-transition');
            transition.classList.remove('active');
            void transition.offsetWidth;
            transition.classList.add('active');
        }

        // Typewriter effect - only for radar section
        function typeWriter(element, text, speed = 35, playSound = false) {
            let i = 0;
            element.textContent = '';
            typingInProgress = playSound && (currentSection === 'radar');
            
            function type() {
                if (i < text.length) {
                    const char = text.charAt(i);
                    element.textContent += char;
                    
                    if (typingInProgress && char.trim() !== '') {
                        playTypingSound();
                    }
                    
                    i++;
                    
                    let nextDelay = speed;
                    if (char === ' ') {
                        nextDelay = speed * 0.3;
                    } else if (char === '.' || char === ',' || char === ':') {
                        nextDelay = speed * 2;
                    } else if (char === '\n') {
                        nextDelay = speed * 3;
                    }
                    
                    setTimeout(type, nextDelay + Math.random() * 10);
                } else {
                    typingInProgress = false;
                }
            }
            type();
        }

        // Loading screen
        if (!hasVisited) {
            const loadingText = `> VAULT-TEC PIP-BOY 3000 Mk IV
> SÄ°STEM BAÅžLATILIYOR...
> DonanÄ±m kontrolÃ¼: BAÅžARILI
> YazÄ±lÄ±m sÃ¼rÃ¼mÃ¼: v3.14.159
> Hava durumu modÃ¼lÃ¼ yÃ¼kleniyor...
> Veri tabanÄ± senkronizasyonu...
> Radar sistemi kalibre ediliyor...
> BaÄŸlantÄ± kuruluyor...
> SÄ°STEM HAZIR`;

            typingInProgress = true;
            typeWriter(document.getElementById('loading-text'), loadingText, 25, true);

            setTimeout(() => {
                typingInProgress = false;
                document.getElementById('loading-screen').classList.add('hidden');
                sessionStorage.setItem('hasVisited', 'true');
                fetchWeather(currentCity);
            }, loadingText.length * 30);
        } else {
            document.getElementById('loading-screen').style.display = 'none';
            fetchWeather(currentCity);
        }

        // Menu
        document.querySelectorAll('.menu-item').forEach(item => {
            item.addEventListener('click', () => {
                playTabSwitchSound();
                triggerScreenTransition();
                
                currentSection = item.dataset.section;
                
                document.querySelectorAll('.menu-item').forEach(m => m.classList.remove('active'));
                item.classList.add('active');
                document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
                document.getElementById(item.dataset.section).classList.add('active');

                if (item.dataset.section === 'radar') {
                    setTimeout(() => {
                        const statusText = `> VAULT-TEC RADAR SÄ°STEMÄ° v3.14
> Sistem durumu: AKTÄ°F
> Kapsama alanÄ±: TÃœRKÄ°YE
> GÃ¼ncelleme sÄ±klÄ±ÄŸÄ±: CANLI
> Son gÃ¼ncelleme: ${new Date().toLocaleString('tr-TR')}
> Radar hassasiyeti: YÃœKSEK
> Meteorolojik veri akÄ±ÅŸÄ±: NORMAL
> BaÄŸlantÄ± durumu: GÃœVENLÄ°`;
                        
                        typeWriter(document.getElementById('radar-status'), statusText, 20, true);
                        
                        setTimeout(() => {
                            const infoText = `> RADAR BÄ°LGÄ°LERÄ°:
  - YaÄŸÄ±ÅŸ tespit sistemi Ã§evrimiÃ§i
  - Bulut takip modÃ¼lÃ¼ aktif
  - RÃ¼zgar analiz sistemi Ã§alÄ±ÅŸÄ±yor
  - SÄ±caklÄ±k haritasÄ± gÃ¼ncelleniyor
  - GerÃ§ek zamanlÄ± veri akÄ±ÅŸÄ± saÄŸlanÄ±yor
  
> UYARI: Radar gÃ¶rÃ¼ntÃ¼leri otomatik gÃ¼ncellenir.

> TÃœRKÄ°YE BÃ–LGESÄ°:
  Merkez: 39Â°N, 35Â°E
  Kapsama: TÃ¼m TÃ¼rkiye
  
> Sistem hazÄ±r. Komutlar iÃ§in butonlarÄ± kullanÄ±n.`;
                            
                            typeWriter(document.getElementById('radar-info'), infoText, 15, true);
                        }, statusText.length * 25);
                    }, 300);
                }
            });

            item.addEventListener('mouseenter', () => {
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = 1000;
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(0.02, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.05);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.05);
            });
        });

        document.querySelectorAll('.pip-button').forEach(button => {
            button.addEventListener('click', () => {
                playClickSound();
            });
        });

        function updateTime() {
            const now = new Date();
            document.getElementById('current-time').textContent = now.toLocaleTimeString('tr-TR', { hour: '2-digit', minute: '2-digit' });
            document.getElementById('timestamp').textContent = now.toLocaleString('tr-TR');
        }
        setInterval(updateTime, 1000);
        updateTime();

        function getVaultBoyAndEffect(condition, isDay) {
            const effectDiv = document.getElementById('weather-effect');
            effectDiv.innerHTML = '';
            const c = condition.toLowerCase();

            if (c.includes('rain') || c.includes('yaÄŸmur') || c.includes('drizzle')) {
                for (let i = 0; i < 50; i++) {
                    const rain = document.createElement('div');
                    rain.className = 'rain';
                    rain.style.left = Math.random() * 100 + '%';
                    rain.style.animationDuration = (Math.random() * 0.5 + 0.5) + 's';
                    rain.style.animationDelay = Math.random() * 2 + 's';
                    effectDiv.appendChild(rain);
                }
                return 'â˜”';
            }

            if (c.includes('snow') || c.includes('kar')) {
                for (let i = 0; i < 30; i++) {
                    const snow = document.createElement('div');
                    snow.className = 'snow';
                    snow.style.left = Math.random() * 100 + '%';
                    snow.style.animationDuration = (Math.random() * 3 + 2) + 's';
                    snow.style.animationDelay = Math.random() * 5 + 's';
                    effectDiv.appendChild(snow);
                }
                return 'â›·ï¸';
            }

            if ((c.includes('clear') || c.includes('sunny') || c.includes('aÃ§Ä±k') || c.includes('gÃ¼neÅŸli')) && isDay) {
                const sun = document.createElement('div');
                sun.className = 'sun-rays';
                effectDiv.appendChild(sun);
                return 'ðŸ˜Ž';
            }

            if ((c.includes('clear') || c.includes('aÃ§Ä±k')) && !isDay) {
                return 'ðŸŒ™';
            }

            if (c.includes('cloud') || c.includes('bulut') || c.includes('kapalÄ±') || c.includes('parÃ§alÄ±')) {
                for (let i = 0; i < 5; i++) {
                    const cloud = document.createElement('div');
                    cloud.className = 'cloud';
                    cloud.style.width = (Math.random() * 100 + 50) + 'px';
                    cloud.style.height = (Math.random() * 40 + 30) + 'px';
                    cloud.style.top = Math.random() * 80 + '%';
                    cloud.style.animationDuration = (Math.random() * 20 + 15) + 's';
                    cloud.style.animationDelay = Math.random() * 10 + 's';
                    effectDiv.appendChild(cloud);
                }
                return 'â˜ï¸';
            }

            if (c.includes('thunder') || c.includes('storm') || c.includes('fÄ±rtÄ±na') || c.includes('gÃ¶k gÃ¼rÃ¼ltÃ¼lÃ¼')) {
                return 'âš¡';
            }

            if (c.includes('mist') || c.includes('fog') || c.includes('sis')) {
                return 'ðŸŒ«ï¸';
            }

            return 'ðŸ¤·';
        }

        function changeRadarLayer(layer) {
            const iframe = document.getElementById('radar-frame');
            const baseUrl = 'https://embed.windy.com/embed2.html?lat=39.000&lon=35.000&detailLat=39.000&detailLon=35.000&width=650&height=450&zoom=6&level=surface';
            
            const layers = {
                'rain': '&overlay=rain&product=ecmwf',
                'clouds': '&overlay=clouds&product=ecmwf',
                'wind': '&overlay=wind&product=ecmwf',
                'temp': '&overlay=temp&product=ecmwf'
            };
            
            iframe.src = baseUrl + layers[layer] + '&menu=&message=&marker=&calendar=now&pressure=&type=map&location=coordinates&detail=&metricWind=default&metricTemp=default&radarRange=-1';
            
            const layerNames = {
                'rain': 'YAÄžIÅž',
                'clouds': 'BULUT',
                'wind': 'RÃœZGAR',
                'temp': 'SICAKLIK'
            };
            
            const infoText = `> ${layerNames[layer]} KATMANI AKTÄ°F
> Harita gÃ¼ncelleniyor...
> Veri yÃ¼kleniyor...
> GÃ¶rÃ¼ntÃ¼leme modu: ${layerNames[layer]}
> GÃ¼ncelleme baÅŸarÄ±lÄ±.`;
            
            typeWriter(document.getElementById('radar-info'), infoText, 25, true);
        }

        async function fetchWeather(city) {
            try {
                const res = await fetch(`https://api.weatherapi.com/v1/forecast.json?key=${apiKey}&q=${city}&days=7&aqi=yes&lang=tr`);
                if (!res.ok) throw new Error('Åžehir bulunamadÄ±');
                const data = await res.json();
                updateUI(data);
                document.getElementById('search-error').innerHTML = '';
                playSelectSound();
            } catch (err) {
                document.getElementById('search-error').innerHTML = `<div class="error">HATA: ${err.message}</div>`;
            }
        }

        function updateUI(data) {
            const c = data.current;
            const l = data.location;
            const f = data.forecast.forecastday;

            document.getElementById('location-name').textContent = l.name;
            document.getElementById('temp-display').textContent = Math.round(c.temp_c) + 'Â°C';
            document.getElementById('feels-like').textContent = Math.round(c.feelslike_c) + 'Â°C';
            document.getElementById('min-max').textContent = `${Math.round(f[0].day.mintemp_c)}Â°C / ${Math.round(f[0].day.maxtemp_c)}Â°C`;
            document.getElementById('humidity').textContent = c.humidity + '%';
            document.getElementById('wind').textContent = Math.round(c.wind_kph) + ' km/h';
            document.getElementById('pressure').textContent = Math.round(c.pressure_mb) + ' mb';
            document.getElementById('visibility').textContent = c.vis_km + ' km';

            const vaultBoy = getVaultBoyAndEffect(c.condition.text, c.is_day === 1);
            document.getElementById('vault-boy').textContent = vaultBoy;
            document.getElementById('weather-desc').textContent = c.condition.text.toUpperCase();

            document.getElementById('sunrise').textContent = f[0].astro.sunrise;
            document.getElementById('sunset').textContent = f[0].astro.sunset;
            document.getElementById('uv-index').textContent = c.uv;
            document.getElementById('clouds').textContent = c.cloud + '%';
            document.getElementById('wind-dir').textContent = c.wind_dir;

            const container = document.getElementById('forecast-container');
            container.innerHTML = '';
            f.forEach((day, i) => {
                const date = new Date(day.date);
                const dayName = i === 0 ? 'BUGÃœN' : date.toLocaleDateString('tr-TR', { weekday: 'short' }).toUpperCase();
                container.innerHTML += `
                    <div class="forecast-item">
                        <div style="font-weight: bold; margin-bottom: 10px;">${dayName}</div>
                        <div style="font-size: 40px; margin: 10px 0;">${getWeatherEmoji(day.day.condition.text)}</div>
                        <div style="font-size: 20px; margin: 10px 0;">${Math.round(day.day.avgtemp_c)}Â°C</div>
                        <div style="font-size: 12px; opacity: 0.8;">${day.day.condition.text}</div>
                    </div>
                `;
            });
        }

        function getWeatherEmoji(condition) {
            const c = condition.toLowerCase();
            if (c.includes('rain') || c.includes('yaÄŸmur')) return 'ðŸŒ§ï¸';
            if (c.includes('snow') || c.includes('kar')) return 'â„ï¸';
            if (c.includes('thunder') || c.includes('fÄ±rtÄ±na')) return 'â›ˆï¸';
            if (c.includes('cloud') || c.includes('bulut') || c.includes('kapalÄ±')) return 'â˜ï¸';
            if (c.includes('clear') || c.includes('sunny') || c.includes('aÃ§Ä±k') || c.includes('gÃ¼neÅŸli')) return 'â˜€ï¸';
            return 'ðŸŒ¤ï¸';
        }

        function searchCity() {
            const city = document.getElementById('city-search').value.trim();
            if (city) {
                currentCity = city;
                fetchWeather(city);
                switchToTab(0);
            }
        }

        function loadCity(city) {
            currentCity = city;
            fetchWeather(city);
            switchToTab(0);
        }

        function switchToTab(index) {
            playTabSwitchSound();
            triggerScreenTransition();
            const items = document.querySelectorAll('.menu-item');
            const sections = document.querySelectorAll('.content-section');
            items.forEach(m => m.classList.remove('active'));
            items[index].classList.add('active');
            sections.forEach(s => s.classList.remove('active'));
            sections[index].classList.add('active');
            currentSection = sections[index].id;
        }

        function getCurrentLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    pos => fetchWeather(`${pos.coords.latitude},${pos.coords.longitude}`),
                    () => alert('Konum alÄ±namadÄ±!')
                );
            }
        }

        function refreshWeather() {
            fetchWeather(currentCity);
        }

        document.getElementById('city-search').addEventListener('keypress', e => {
            if (e.key === 'Enter') searchCity();
        });

        console.log('%c> PIP-BOY HAVA DURUMU - BAÅžLATILIYOR...', 'color: #0f0; font-family: monospace; font-size: 16px;');
        console.log('%c> Vault-Tec Weather System - ONLINE', 'color: #0f0; font-family: monospace;');
    </script>
</body>
</html>
